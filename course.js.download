!function($){function runnecessaryfunctions(){jQuery(".fitvids").fitVids(),jQuery(".tip").tooltip(),jQuery(".nav-tabs li:first a").tab("show"),jQuery(".nav-tabs li a").click(function(e){e.preventDefault(),$(this).tab("show")}),$("audio,video").mediaelementplayer(),jQuery(".gallery").magnificPopup({delegate:"a",type:"image",tLoading:"Loading image #%curr%...",mainClass:"mfp-img-mobile",gallery:{enabled:!0,navigateByImgClick:!0,preload:[0,1]},image:{tError:'<a href="%url%">The image #%curr%</a> could not be loaded.',titleSrc:function(e){return e.el.attr("title")}}}),$(".open_popup_link").magnificPopup({type:"inline",midClick:!0}),$(".ajax-popup-link").magnificPopup({type:"ajax",alignTop:!0,fixedContentPos:!0,fixedBgPos:!0,overflowY:"auto",closeBtnInside:!0,preloader:!1,midClick:!0,removalDelay:300,mainClass:"my-mfp-zoom-in"}),$(".quiz_results_popup").magnificPopup({type:"ajax",alignTop:!0,fixedContentPos:!0,fixedBgPos:!0,overflowY:"auto",closeBtnInside:!0,preloader:!1,midClick:!0,removalDelay:300,mainClass:"my-mfp-zoom-in",callbacks:{parseAjax:function(e){e.data=$(e.data).find("#item-body")},ajaxContentAdded:function(){$(".show_explaination").on("click",function(e){e.preventDefault();var t=$(this);t.toggleClass("active"),t.closest("li").find(".explaination").toggle()}),$("#prev_results a").on("click",function(e){e.preventDefault(),$(this).toggleClass("show"),$(".prev_quiz_results").toggleClass("show")}),$(".print_results").click(function(e){e.preventDefault(),$(".quiz_result").print()}),$(".quiz_retake_form.start_quiz").on("click",function(e){e.preventDefault();var t=$("#unit.quiz_title").attr("data-unit");$.ajax({type:"POST",url:ajaxurl,data:{action:"retake_inquiz",security:$("#hash").val(),quiz_id:t},cache:!1,success:function(e){$('a.unit[data-unit="'+t+'"]').trigger("click"),$.magnificPopup.close(),$("#unit"+t).removeClass("done");for(var i=localStorage.length;i--;){var a=localStorage.key(i);$.isNumeric(a)&&localStorage.removeItem(a)}$("body").find(".course_progressbar").removeClass("increment_complete"),$("body").find(".course_progressbar").trigger("decrement")}})})}}}),$(".live-edit").liveEdit({afterSaveAll:function(e){return!1}}),"function"==typeof vc_js&&window.vc_js()}function ajaxsubmit_comments(){$("#question").each(function(){var e=$(this);$("#submit").click(function(t){t.preventDefault();var i="";$("#ajaxloader").removeClass("disabled"),$("#question").css("opacity",.2),e.find('input[type="radio"]:checked').length&&e.find('input[type="radio"]:checked').each(function(){i=$(this).val()}),e.find('input[type="checkbox"]:checked').length&&e.find('input[type="checkbox"]:checked').each(function(){i=$(this).val()+","+i}),e.find(".vibe_fillblank").length&&e.find(".vibe_fillblank").each(function(){i+=$(this).text()}),e.find("#vibe_select_dropdown").length&&(i=e.find("#vibe_select_dropdown").val()),e.find(".matchgrid_options li.match_option").length&&$(".matchgrid_options li.match_option").each(function(){var e=$(this).attr("id");jQuery.isNumeric(e)&&(i+=e+",")}),$("#comment").hasClass("option_value")&&$("#comment.option_value").val(i),$("#commentform").submit()});var t=$("#commentform"),i=$("#comment-status"),a=i.attr("data-quesid");t.submit(function(){var e=t.serialize();i.html("<p>"+vibe_course_module_strings.processing+"</p>");var s=t.attr("action");return $.ajax({type:"post",url:s,data:e,error:function(e,t,a){$("#ajaxloader").addClass("disabled"),$("#question").css("opacity",1),i.html('<p class="wdpajax-error">'+vibe_course_module_strings.too_fast_answer+"</p>"),setTimeout(function(){i.hide(300).html("").show()},2e3)},success:function(e,t){$("#question").css("opacity",1),$("#ajaxloader").addClass("disabled"),"success"==e?(i.html('<p class="ajax-success" >'+vibe_course_module_strings.answer_saved+"</p>"),setTimeout(function(){i.hide(300).html("").show()},2e3),$("#ques"+a).addClass("done"),$(".reset_answer").removeClass("hide")):(i.html('<p class="ajax-error" >'+vibe_course_module_strings.saving_answer+"</p>"),setTimeout(function(){i.hide(300).html("").show()},2e3))}}),!1})})}function calculate_total_marks(){$(".question_marks").blur(function(){var e=parseInt(0),t=$("#total_marks strong > span");$(".question_marks").each(function(){$(this).val()&&(e+=parseInt($(this).val()))}),t.html(e)})}$.fn.timer=function(e){var t,i,a=$(this),s=0;t=$.extend({timer:300,width:24,height:24,fgColor:"#ED7A53",bgColor:"#232323"},e),a.knob({min:0,max:t.timer,readOnly:!0,width:t.width,height:t.height,fgColor:t.fgColor,bgColor:t.bgColor,displayInput:!1,dynamicDraw:!1,ticks:0,thickness:.1}),setInterval(function(){i=++s,a.val(i).trigger("change")},1e3)},$.urlParam=function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null==t?null:t[1]||0},jQuery(document).ready(function(e){function t(){e(".category_filter .bp-course-category-filter,.type_filter .bp-course-free-filter,.level_filter .bp-course-level-filter,.instructor_filter .bp-course-instructor-filter").on("click",function(){var t=[];e(".bp-course-category-filter:checked").each(function(){var i={type:"course-cat",value:e(this).val()};t.push(i)}),e(".bp-course-free-filter:checked").each(function(){var i={type:"free",value:e(this).val()};t.push(i)}),e(".bp-course-level-filter:checked").each(function(){var i={type:"level",value:e(this).val()};t.push(i)}),e(".bp-course-instructor-filter:checked").each(function(){var i={type:"instructor",value:e(this).val()};t.push(i)}),e.cookie("bp-course-extras",JSON.stringify(t),{expires:1,path:"/"})})}function i(){var t=e.cookie("bp-course-extras");if(null!==t){var i=JSON.parse(t);e("#active_filters").length?e("#active_filters").fadeIn(200):e("#course-dir-list").before('<ul id="active_filters"><li>'+vibe_course_module_strings.active_filters+"</li></ul>"),jQuery.each(i,function(t,i){e('input[value="'+i.value+'"]').prop("checked",!0);var a=e('input[value="'+i.value+'"]').attr("id"),s=e('label[for="'+a+'"]').text();e('#active_filters span[data-id="'+a+'"]').length||e("#active_filters").append('<li><span data-id="'+a+'">'+s+"</span></li>")}),e("#active_filters li span").on("click",function(){var t=e(this).attr("data-id");e(this).parent().fadeOut(200,function(){e(this).remove(),e("#active_filters li").length<3?e("#active_filters").fadeOut(200):e("#active_filters").fadeIn(200)}),e("#"+t).prop("checked",!1);var i=[];e(".bp-course-category-filter:checked").each(function(){var t={type:"course-cat",value:e(this).val()};i.push(t)}),e(".bp-course-free-filter:checked").each(function(){var t={type:"free",value:e(this).val()};i.push(t)}),e(".bp-course-level-filter:checked").each(function(){var t={type:"level",value:e(this).val()};i.push(t)}),e(".bp-course-instructor-filter:checked").each(function(){var t={type:"instructor",value:e(this).val()};i.push(t)}),e.cookie("bp-course-extras",JSON.stringify(i),{expires:1,path:"/"}),e("#submit_filters").trigger("click")}),e("#active_filters .all-filter-clear").length||e("#active_filters").append('<li class="all-filter-clear">'+vibe_course_module_strings.clear_filters+"</li>"),e("#active_filters li.all-filter-clear").click(function(){e("#active_filters li").each(function(){var t=e(this).find("span"),i=t.attr("data-id");t.parent().fadeOut(200,function(){e(this).remove()}),e("#"+i).prop("checked",!1),e("#active_filters").fadeOut(200,function(){e(this).remove()}),e.removeCookie("bp-course-extras",{path:"/"}),e("#submit_filters").trigger("click")})}),e("#active_filters li").length<3?e("#active_filters").fadeOut(200):e("#active_filters").fadeIn(200)}}e(".open_popup_link").magnificPopup({type:"inline",midClick:!0}),e(".item-list").each(function(){var t="bp-"+e(".item-list").attr("id"),i=e.cookie(t);null!==i&&"grid"==i&&(e(".item-list").addClass("grid"),e("#list_view").removeClass("active"),e("#grid_view").addClass("active"))}),i(),t(),e(".category_filter li > span,.category_filter li > label").click(function(t){var i=e(this).parent();e(".category_filter li > span").toggleClass("active"),i.find("ul.sub_categories").toggle(300)}),e("#submit_filters").on("click",function(){if(jq(".item-list-tabs li.selected").length)var e=jq(".item-list-tabs li.selected");else var e=jq(this);var a=e.attr("id").split("-"),s=a[0],n=a[1],r=jq(this).val(),o=!1;return jq(".dir-search input").length&&(o=jq(".dir-search input").val()),"friends"==s&&(s="members"),t(),bp_filter_request(s,r,n,"div."+s,o,1,jq.cookie("bp-"+s+"-extras")),i(),!1}),e(".quiz_results_popup").magnificPopup({type:"ajax",alignTop:!0,fixedContentPos:!0,fixedBgPos:!0,overflowY:"auto",closeBtnInside:!0,preloader:!1,midClick:!0,removalDelay:300,mainClass:"my-mfp-zoom-in",callbacks:{parseAjax:function(t){t.data=e(t.data).find("#item-body")},ajaxContentAdded:function(){e("#prev_results a").on("click",function(t){t.preventDefault(),e(this).toggleClass("show"),e(".prev_quiz_results").toggleClass("show")}),e(".print_results").click(function(t){t.preventDefault(),e(".quiz_result").print()}),e(".quiz_retake_form.start_quiz").on("click",function(t){t.preventDefault();var i=e("#unit.quiz_title").attr("data-unit");e.ajax({type:"POST",url:ajaxurl,data:{action:"retake_inquiz",security:e("#hash").val(),quiz_id:i},cache:!1,success:function(t){e('a.unit[data-unit="'+i+'"]').trigger("click"),e.magnificPopup.close(),e("#unit"+i).removeClass("done"),e("body").find(".course_progressbar").removeClass("increment_complete"),e("body").find(".course_progressbar").trigger("decrement")}})})}}}),e("#grid_view").click(function(){e(".item-list").hasClass("grid")||e(".item-list").addClass("grid");var t="bp-"+e(".item-list").attr("id");e.cookie(t,"grid",{expires:2,path:"/"}),e("#list_view").removeClass("active"),e(this).addClass("active")}),e("#list_view").click(function(){e(".item-list").removeClass("grid");var t="bp-"+e(".item-list").attr("id");e.cookie(t,"list",{expires:2,path:"/"}),e("#grid_view").removeClass("active"),e(this).addClass("active")}),e("#average .dial").knob({readOnly:!0,width:120,height:120,fgColor:vibe_course_module_strings.theme_color,bgColor:"#f6f6f6",thickness:.1}),e("#pass .dial").knob({readOnly:!0,width:120,height:120,fgColor:vibe_course_module_strings.theme_color,bgColor:"#f6f6f6",thickness:.1}),e("#badge .dial").knob({readOnly:!0,width:120,height:120,fgColor:vibe_course_module_strings.theme_color,bgColor:"#f6f6f6",thickness:.1}),e(".course_quiz .dial").knob({readOnly:!0,width:120,height:120,fgColor:vibe_course_module_strings.theme_color,bgColor:"#f6f6f6",thickness:.1}),e("body").delegate(".remove_user_course","click",function(t){t.preventDefault();var i=e(this).attr("data-course"),a=e(this).attr("data-user");e(this).addClass("animated spin");var s=e(this);e.confirm({text:vibe_course_module_strings.remove_user_text,confirm:function(){e.ajax({type:"POST",url:ajaxurl,data:{action:"remove_user_course",security:e("#security").val(),id:i,user:a},cache:!1,success:function(t){e(this).removeClass("animated"),e(this).removeClass("spin"),runnecessaryfunctions(),e("#message").html(t),e("#s"+a).fadeOut("fast")}})},cancel:function(){s.removeClass("animated"),s.removeClass("spin")},confirmButton:vibe_course_module_strings.remove_user_button,cancelButton:vibe_course_module_strings.cancel})}),e("body").delegate(".reset_course_user","click",function(t){t.preventDefault();var i=e(this).attr("data-course"),a=e(this).attr("data-user");e(this).addClass("animated spin");var s=e(this);e.confirm({text:vibe_course_module_strings.reset_user_text,confirm:function(){e.ajax({type:"POST",url:ajaxurl,data:{action:"reset_course_user",security:e("#security").val(),id:i,user:a},cache:!1,success:function(t){s.removeClass("animated"),s.removeClass("spin");var a="course_progress"+i;e.removeCookie(a,{path:"/"}),e("#message").html(t)}})},cancel:function(){s.removeClass("animated"),s.removeClass("spin")},confirmButton:vibe_course_module_strings.reset_user_button,cancelButton:vibe_course_module_strings.cancel})}),e("body").delegate(".tip.course_stats_user","click",function(t){t.preventDefault();var i=e(this),a=i.attr("data-course"),s=i.attr("data-user");i.hasClass("already")?e("#s"+s).find(".course_stats_user").fadeIn("fast"):(i.addClass("animated spin"),e.ajax({type:"POST",url:ajaxurl,data:{action:"course_stats_user",security:e("#security").val(),id:a,user:s},cache:!1,success:function(t){i.removeClass("animated"),i.removeClass("spin"),i.addClass("already"),e("#s"+s).append(t),e(".course_students").trigger("load_quiz_results"),e(".dial").knob({readOnly:!0,width:160,height:160,fgColor:vibe_course_module_strings.theme_color,bgColor:"#f6f6f6",thickness:.3})}}))}),e(".course_students").on("load_quiz_results",function(){e(".check_user_quiz_results").click(function(){e.ajax({type:"POST",url:ajaxurl,data:{action:"check_user_quiz_results",quiz:e(this).attr("data-quiz"),user:e(this).attr("data-user"),security:e("#security").val()},cache:!1,success:function(t){e.magnificPopup.open({items:{src:e('<div class="white-popup">'+t+"</div>"),type:"inline"}})}})})}),e(".data_stats li").click(function(t){t.preventDefault();var i=e(this).html(),a=(e(".content"),e(this)),s=e(this).attr("id");if("desc"==s)e(".main_content").show(),e(".stats_content").hide();else if(e(this).hasClass("loaded"))e(".main_content").hide(),e(".stats_content").show();else{a.addClass("loaded"),e(".main_content").hide(),e(this).html('<i class="icon-sun-stroke"></i>');var n=a.parent().attr("data-id"),r=a.parent().attr("data-type");e.ajax({type:"POST",url:ajaxurl,data:{action:"load_stats",cpttype:r,id:n},cache:!1,success:function(t){e(".main_content").after(t),setTimeout(function(){a.html(i)},1e3)}})}a.parent().find(".active").removeClass("active"),a.addClass("active")}),e("#calculate_avg_course").click(function(t){t.preventDefault();var i=e(this).attr("data-courseid");e(this).addClass("animated spin"),e.ajax({type:"POST",url:ajaxurl,data:{action:"calculate_stats_course",security:e("#security").val(),id:i},cache:!1,success:function(t){e(this).removeClass("animated"),e(this).removeClass("spin"),e("#message").html(t),setTimeout(function(){location.reload()},3e3)}})}),e(".reset_quiz_user").click(function(t){t.preventDefault();var i=e(this).attr("data-quiz"),a=e(this).attr("data-user");e(this).addClass("animated spin");var s=e(this);e.confirm({text:vibe_course_module_strings.quiz_rest,confirm:function(){e.ajax({type:"POST",url:ajaxurl,data:{action:"reset_quiz",security:e("#qsecurity").val(),id:i,user:a},cache:!1,success:function(t){e(this).removeClass("animated"),e(this).removeClass("spin"),e("#message").html(t),e("#qs"+a).fadeOut("fast")}})},cancel:function(){s.removeClass("animated"),s.removeClass("spin")},confirmButton:vibe_course_module_strings.quiz_rest_button,cancelButton:vibe_course_module_strings.cancel})}),e(".evaluate_quiz_user").click(function(t){t.preventDefault();var i=e(this).attr("data-quiz"),a=e(this).attr("data-user");e(this).addClass("animated spin"),e.ajax({type:"POST",url:ajaxurl,data:{action:"evaluate_quiz",security:e("#qsecurity").val(),id:i,user:a},cache:!1,success:function(t){e(this).removeClass("animated"),e(this).removeClass("spin"),e(".quiz_students").html(t),calculate_total_marks()}})}),e(".evaluate_course_user").click(function(t){t.preventDefault();var i=e(this).attr("data-course"),a=e(this).attr("data-user");e(this).addClass("animated spin"),e.ajax({type:"POST",url:ajaxurl,data:{action:"evaluate_course",security:e("#security").val(),id:i,user:a},cache:!1,success:function(t){e(this).removeClass("animated"),e(this).removeClass("spin"),e(".course_students").html(t),calculate_total_marks()}})}),e("body").delegate(".reset_answer","click",function(t){t.preventDefault();var i=e("#comment-status").attr("data-quesid"),a=e(this),s=e("#comment-status").attr("data-quesid");a.prepend('<i class="icon-sun-stroke animated spin"></i>'),e.ajax({type:"POST",url:ajaxurl,data:{action:"reset_question_answer",security:a.attr("data-security"),ques_id:i},cache:!1,success:function(t){a.find("i").remove(),e("#comment-status").html(t),e("#ques"+s).removeClass("done"),setTimeout(function(){a.addClass("hide")},500)}})}),e("body").delegate("#course_complete","click",function(t){t.preventDefault();var i=e(this),a=i.attr("data-user"),s=i.attr("data-course"),n=parseInt(e("#course_marks_field").val());return 0>=n?void alert("Enter Marks for User"):(i.prepend('<i class="icon-sun-stroke animated spin"></i>'),void e.ajax({type:"POST",url:ajaxurl,data:{action:"complete_course_marks",security:e("#security").val(),course:s,user:a,marks:n},cache:!1,success:function(e){i.find("i").remove(),i.html(e)}}))}),e(".register-section h4").click(function(){e(this).toggleClass("show"),e(this).parent().find(".editfield").toggle("fast")})}),$("body").delegate(".hide_parent","click",function(e){$(this).parent().fadeOut("fast")}),$("body").delegate(".give_marks","click",function(e){e.preventDefault();var t=$(this),i=t.attr("data-ans-id"),a=$("#"+i).val();t.prepend('<i class="icon-sun-stroke animated spin"></i>'),$.ajax({type:"POST",url:ajaxurl,data:{action:"give_marks",aid:i,aval:a},cache:!1,success:function(e){t.find("i").remove(),t.html(vibe_course_module_strings.marks_saved)}})}),$("body").delegate("#mark_complete","click",function(e){e.preventDefault();var t=$(this),i=t.attr("data-quiz"),a=t.attr("data-user"),s=parseInt($("#total_marks strong > span").text());t.prepend('<i class="icon-sun-stroke animated spin"></i>'),$.ajax({type:"POST",url:ajaxurl,data:{action:"save_quiz_marks",quiz_id:i,user_id:a,marks:s},cache:!1,success:function(e){t.find("i").remove(),t.html(vibe_course_module_strings.quiz_marks_saved)}})}),$("body").delegate(".submit_quiz","click",function(e){if(e.preventDefault(),$("#question").css("opacity",.2),$("#ajaxloader").removeClass("disabled"),$(this).hasClass("disabled"))return!1;var t=$(this);t.prepend('<i class="icon-sun-stroke animated spin"></i>'),$("#question").addClass("quiz_submitted_fade");var i=$(this).attr("data-quiz"),a=[],s=0;$.each(all_questions_json,function(e,t){var i=localStorage.getItem(t);if(i){var n={id:t,value:i};a.push(n),localStorage.removeItem(t)}else s++}),$.ajax({type:"POST",url:ajaxurl,async:!0,data:{action:"submit_quiz",security:$("#start_quiz").val(),quiz_id:i,answers:JSON.stringify(a)},cache:!1,success:function(e){window.location.assign(document.URL)}})}),jQuery(document).ready(function(e){e(".begin_quiz").click(function(t){var i=e(this);if(i.hasClass("begin_quiz")){t.preventDefault();var a=e(this).attr("data-quiz");i.prepend('<i class="icon-sun-stroke animated spin"></i>'),e.ajax({type:"POST",url:ajaxurl,data:{action:"begin_quiz",start_quiz:e("#start_quiz").val(),id:a},cache:!1,success:function(t){i.find("i").remove(),e(".content").fadeOut("fast"),e(".content").html(t),e(".content").fadeIn("fast"),ajaxsubmit_comments();var s=e(e.parseHTML(t)).filter("#question"),n="#ques"+s.attr("data-ques"),r=[];e(".quiz_question").each(function(){var t=e(this).attr("data-qid"),i=localStorage.getItem(t);if(null!=i)e("#ques"+t).addClass("done");else{var a={id:t};r.push(a)}}),r.length&&e.ajax({type:"POST",url:ajaxurl,data:{action:"check_unanswered_questions",id:a,questions:JSON.stringify(r)},cache:!1,success:function(t){t=jQuery.parseJSON(t),e.each(t,function(t,i){e("#ques"+i.question_id).addClass("done"),localStorage.setItem(i.question_id,i.value)})}}),e(".quiz_timeline").find(".active").removeClass("active"),e(n).addClass("active"),e("#question").trigger("question_loaded"),"undefined"!=s&&e(".quiz_timer").trigger("activate"),runnecessaryfunctions(),e(".begin_quiz").each(function(){e(this).removeClass("begin_quiz"),e(this).addClass("submit_quiz"),e(this).text(vibe_course_module_strings.submit_quiz)})}})}})}),$("body").delegate(".show_hint","click",function(e){e.preventDefault(),$(this).toggleClass("active"),$(this).parent().find(".hint").toggle(400)}),$(".show_explaination").click(function(e){e.preventDefault();var t=$(this);t.toggleClass("active"),t.closest("li").find(".explaination").toggle()}),$("body").delegate(".quiz_question","click",function(e){e.preventDefault();var t=$(this),i=$(this).attr("data-quiz"),a=$(this).attr("data-qid");t.prepend('<i class="icon-sun-stroke animated spin"></i>'),$("#ajaxloader").removeClass("disabled"),$("#question").css("opacity",.2),$.ajax({type:"POST",url:ajaxurl,data:{action:"quiz_question",start_quiz:$("#start_quiz").val(),quiz_id:i,ques_id:a},cache:!1,success:function(e){t.find("i").remove(),$(".content").html(e),$("#ajaxloader").addClass("disabled"),$("#question").css("opacity",1),ajaxsubmit_comments();var i=$($.parseHTML(e)).filter("#question"),a="#ques"+i.attr("data-ques");$(".quiz_timeline").find(".active").removeClass("active"),$(a).addClass("active"),$("#question").trigger("question_loaded"),$(".tip").tooltip(),$("audio,video").mediaelementplayer(),$(".timeline_wrapper").height()>$(".quiz_timeline").height()&&$(".quiz_timeline").animate({scrollTop:$(a).position().top},"slow")}})}),$("body").delegate("#question","question_loaded",function(){runnecessaryfunctions();var e=$(this),t=e.attr("data-ques"),i=e.find("#question_marked_answer"+t).val(),a=localStorage.getItem(t);if(null==a&&i.length&&(a=i,localStorage.setItem(t,i),$("#ques"+t).hasClass("done")||$("#ques"+t).addClass("done")),$(this).find(".question_options.truefalse").length&&(null!=a&&$(this).find('input[value="'+a+'"]').attr("checked","checked"),$(".question_options.truefalse").click(function(){e=$(".question_options.truefalse"),e.find('input[type="radio"]:checked').length&&e.find('input[type="radio"]:checked').each(function(){a=$(this).val(),localStorage.setItem(t,a),$("#ques"+t).addClass("done")})})),$(this).find(".question_options.single").length&&(null!=a&&$(this).find('input[value="'+a+'"]').attr("checked","checked"),$(".question_options.single").click(function(){e=$(".question_options.single"),e.find('input[type="radio"]:checked').length&&e.find('input[type="radio"]:checked').each(function(){a=$(this).val(),localStorage.setItem(t,a),$("#ques"+t).addClass("done")})})),$(this).find(".question_options.multiple").length){if(null!=a){var s=a.split(",");$.each(s,function(t,i){e.find('input[value="'+i+'"]').prop("checked",!0)})}$(".question_options.multiple").click(function(){e=$(".question_options.multiple"),a="",e.find('input[type="checkbox"]:checked').length&&e.find('input[type="checkbox"]:checked').each(function(){a=$(this).val()+","+a}),localStorage.setItem(t,a),$("#ques"+t).addClass("done")})}if(e.find(".single_text").length&&null!=a&&e.find('.single_text input[type="text"]').val(a),$('.single_text input[type="text"]').on("blur",function(){var e=$(this).val();localStorage.setItem(t,e),$("#ques"+t).addClass("done")}),e.find(".vibe_fillblank").length&&null!=a&&$(this).find(".vibe_fillblank").text(a),$(".vibe_fillblank").on("blur",function(){$(this).find("p").each(function(){a=$(this).text()}),localStorage.setItem(t,a),$("#ques"+t).addClass("done")}),$(this).find("#vibe_select_dropdown").length&&(null!=a&&$("#vibe_select_dropdown").val(a),$("#vibe_select_dropdown").change(function(){var e=$("#vibe_select_dropdown").val();localStorage.setItem(t,e),$("#ques"+t).addClass("done")})),$(this).find(".matchgrid_options li.match_option").length&&($(".matchgrid_options li.match_option").each(function(){var e=$(this).attr("id");jQuery.isNumeric(e)&&(a+=e+",")}),localStorage.setItem(t,a)),jQuery(".question_options.sort").each(function(){if(null!=a)for(var e=a.split(","),i=$(".question_options"),s=$(".question_options").children(),n=e[e.length-1];n>=0;n--)i.prepend(s.get(e[n]-1));else{var r="1",o=$("ul.question_options li").size();if(o>1)for(var n=2;o>=n;n++)r=r+","+n;localStorage.setItem(t,r)}$("#comment").val(r),$("#comment").trigger("change"),jQuery(".question_options.sort").sortable({revert:!0,cursor:"move",refreshPositions:!0,opacity:.6,scroll:!0,containment:"parent",placeholder:"placeholder",tolerance:"pointer",update:function(e,i){var a=$(".question_options.sort").sortable("toArray").toString();localStorage.setItem(t,a),$("#ques"+t).addClass("done")}}).disableSelection()}),$(".live-edit").liveEdit({afterSaveAll:function(e){return!1}}),$(".question_options.match").length){$(".question_options.match").droppable({drop:function(e,t){$(t.draggable).removeAttr("style"),$(this).addClass("ui-state-highlight").append($(t.draggable))}}),$(".question_options.match li").draggable({revert:"invalid",containment:"#question"}),$(".matchgrid_options li").droppable({activeClass:"ui-state-default",hoverClass:"ui-state-hover",drop:function(e,i){if(childCount=$(this).find("li").length,$("#ques"+t).addClass("done"),$(i.draggable).removeAttr("style"),0==childCount){$(this).addClass("ui-state-highlight").append($(i.draggable));var a="",s=[];$(this).parent().find("li.match_option").each(function(){var e=$(this).attr("id");jQuery.isNumeric(e)&&s.push(e)}),a=s.join(", "),localStorage.setItem(t,a)}}});var n;if($(".matchgrid_options li").each(function(e,i){n=$(".matchgrid_options").attr("data-match"+e),$(this).append($("#"+n)),$("#ques"+t).addClass("done")}),null!=a)for(var s=a.split(","),r=($(".question_options.match"),$(".question_options.match").children()),o=s.length-1;o>=0;o--)$(".matchgrid_options ul li").eq(o).append(r.get(s[o]-1))}}),jQuery(document).ready(function(e){e(".quiz_timer").one("activate",function(){var t=parseInt(e(this).attr("data-time")),i=e(this).find(".timer"),a=e(this);i.timer({timer:t,width:200,height:200,fgColor:vibe_course_module_strings.theme_color,bgColor:vibe_course_module_strings.single_dark_color});var i=e(this).find(".timer");i.on("change",function(){var t=a.find(".countdown"),s=parseInt(i.attr("data-timer"));if(s>0){s--,i.attr("data-timer",s);var n="";n=s>60?Math.floor(s/60)+":"+(parseInt(s%60)<10?"0"+parseInt(s%60):parseInt(s%60)):"00:"+(10>s?"0"+s:s),t.html(n)}else t.html(vibe_course_module_strings.theme_color),e(".submit_quiz").hasClass("triggerred")||(e(".submit_quiz").trigger("click"),e(".submit_quiz").addClass("triggerred")),e(".quiz_timer").trigger("end")})}),e(".quiz_timer").one("deactivate",function(){var t=parseInt(e(this).attr("data-time")),i=e(this).find(".timer");e(this);i.knob({readonly:!0,max:t,width:200,height:200,fgColor:vibe_course_module_strings.theme_color,bgColor:vibe_course_module_strings.single_dark_color,thickness:.2,readonly:!0}),event.stopPropagation()}),e(".quiz_timer").one("end",function(t){var i=parseInt(e(this).attr("data-time")),a=e(this).find(".timer");e(this);a.knob({readonly:!0,max:i,width:200,height:200,fgColor:vibe_course_module_strings.theme_color,bgColor:vibe_course_module_strings.single_dark_color,thickness:.2,readonly:!0}),t.stopPropagation()}),e(".quiz_timer").each(function(){var t=parseInt(e(this).attr("data-time")),i=e(this).find(".timer");i.knob({readonly:!0,max:t,width:200,height:200,fgColor:vibe_course_module_strings.theme_color,bgColor:vibe_course_module_strings.single_dark_color,thickness:.2,readonly:!0}),e(this).hasClass("start")&&e(".quiz_timer").trigger("activate")}),jQuery(".question_options.sort").each(function(){var t="1",i=e("ul.question_options li").size();if(i>1)for(var a=2;i>=a;a++)t=t+","+a;e("#comment").val(t),e("#comment").trigger("change"),jQuery(".question_options.sort").sortable({revert:!0,cursor:"move",refreshPositions:!0,opacity:.6,scroll:!0,containment:"parent",placeholder:"placeholder",tolerance:"pointer",update:function(t,i){var a=e(".question_options.sort").sortable("toArray").toString();e("#comment").val(a),e("#comment").trigger("change")}}).disableSelection()})}),$("body").on("click",".expand_message",function(e){if($(this).hasClass("expand_message_all")){e.preventDefault();var t=$(".bulk_message").is(":hidden");t&&$(".bulk_message").toggle("slow"),$(".bulk_message").addClass("all"),$(".member").each(function(){$(this).prop("checked",!0)})}else{e.preventDefault();var t=$(".bulk_message").is(":hidden");t&&$(".bulk_message").toggle("slow"),$(".bulk_message").removeClass("all"),$(".member").each(function(){$(this).prop("checked",!1)})}}),$("body").on("click",".expand_change_status",function(e){e.preventDefault(),$(".bulk_change_status").toggle("slow"),$("#status_action").on("change",function(){"finish_course"===$(this).val()?$("#finish_marks").removeClass("hide"):$("#finish_marks").addClass("hide")})}),$("body").on("click",".expand_add_students",function(e){e.preventDefault(),$(".bulk_add_students").toggle("slow")}),$("body").on("click",".expand_assign_students",function(e){e.preventDefault(),$(".bulk_assign_students").toggle("slow")}),$("body").on("click",".extend_subscription_students",function(e){e.preventDefault(),$(".bulk_extend_subscription_students").toggle("slow")}),$("body").delegate("#send_course_message","click",function(e){e.preventDefault();var t=[],i=$(this),a=i.html();if(i.html('<i class="icon-sun-stroke animated spin"></i> '+vibe_course_module_strings.sending_messages),$(this).parent().hasClass("all")){var s=$("#members-id").val();""!==s&&(t=s.split(","))}else{var n=0;$(".member").each(function(){$(this).is(":checked")&&(t[n]=$(this).val(),n++)})}$.ajax({type:"POST",url:ajaxurl,data:{action:"send_bulk_message",security:$("#bulk_action").val(),course:i.attr("data-course"),sender:$("#sender").val(),members:JSON.stringify(t),subject:$("#bulk_subject").val(),message:$("#bulk_message").val()},cache:!1,success:function(e){$("#send_course_message").html(e),setTimeout(function(){i.html(a)},5e3)}})}),$("body").delegate("#add_student_to_course","click",function(e){e.preventDefault();var t=$(this),i=t.html(),a=$("#student_usernames").val();if(a.length<=0)return $("#add_student_to_course").html(vibe_course_module_strings.unable_add_students),void setTimeout(function(){t.html(i)},2e3);t.html('<i class="icon-sun-stroke animated spin"></i>'+vibe_course_module_strings.adding_students);$.ajax({type:"POST",url:ajaxurl,data:{action:"add_bulk_students",security:$("#bulk_action").val(),course:t.attr("data-course"),members:a},cache:!1,success:function(e){e.length&&"0"!==e?($("#add_student_to_course").html(vibe_course_module_strings.successfuly_added_students),$("ul.course_students").append(e)):$("#add_student_to_course").html(vibe_course_module_strings.unable_add_students),setTimeout(function(){t.html(i)},3e3)}})}),$("body").delegate("#download_stats","click",function(e){e.preventDefault();var t=$(this),i=t.html(),a=0,s=[];return $(".field:checked").each(function(){s[a]=$(this).attr("id"),a++}),0==a?(t.html(vibe_course_module_strings.select_fields),setTimeout(function(){t.html(i)},13e3),!1):(t.html('<i class="icon-sun-stroke animated spin"></i> '+vibe_course_module_strings.processing),void $.ajax({type:"POST",url:ajaxurl,data:{action:"download_stats",security:$("#stats_security").val(),course:t.attr("data-course"),fields:JSON.stringify(s),type:$("#stats_students").val()},cache:!1,success:function(e){t.attr("href",e),t.attr("id","download"),t.html(vibe_course_module_strings.download)}}))}),$("body").delegate("#download_mod_stats","click",function(e){e.preventDefault();var t=$(this),i=t.html(),a=0,s=[];return $(".field:checked").each(function(){s[a]=$(this).attr("id"),a++}),0==a?(t.html(vibe_course_module_strings.select_fields),setTimeout(function(){t.html(i)},13e3),!1):(t.html('<i class="icon-sun-stroke animated spin"></i> '+vibe_course_module_strings.processing),void $.ajax({type:"POST",url:ajaxurl,data:{action:"download_mod_stats",security:$("#stats_security").val(),type:t.attr("data-type"),id:t.attr("data-id"),fields:JSON.stringify(s),select:$("#stats_students").val()},cache:!1,success:function(e){t.attr("href",e),t.attr("id","download"),t.html(vibe_course_module_strings.download)}}))}),$("body").delegate("#assign_course_badge_certificate","click",function(e){e.preventDefault();var t=[],i=$(this),a=i.html();i.html('<i class="icon-sun-stroke animated spin"></i> '+vibe_course_module_strings.processing);var s=0;$(".member").each(function(){$(this).is(":checked")&&(t[s]=$(this).val(),s++)}),$.ajax({type:"POST",url:ajaxurl,data:{action:"assign_badge_certificates",security:$("#bulk_action").val(),course:i.attr("data-course"),members:JSON.stringify(t),assign_action:$("#assign_action").val()},cache:!1,success:function(e){i.html(e),setTimeout(function(){i.html(a)},5e3);
}})}),$("body").delegate("#change_course_status","click",function(e){e.preventDefault();var t=[],i=$(this),a=i.html();i.html('<i class="icon-sun-stroke animated spin"></i> '+vibe_course_module_strings.processing);var s=0;$(".member").each(function(){$(this).is(":checked")&&(t[s]=$(this).val(),s++)}),$.ajax({type:"POST",url:ajaxurl,data:{action:"change_course_status",security:$("#bulk_action").val(),course:i.attr("data-course"),members:JSON.stringify(t),status_action:$("#status_action").val(),data:$("#finish_marks").val()},cache:!1,success:function(e){i.html(e),setTimeout(function(){i.html(a)},5e3)}})}),$("body").delegate("#extend_course_subscription","click",function(e){e.preventDefault();var t=[],i=$(this),a=i.html();i.html('<i class="icon-sun-stroke animated spin"></i> '+vibe_course_module_strings.processing);var s=0;$(".member").each(function(){$(this).is(":checked")&&(t[s]=$(this).val(),s++)}),$.ajax({type:"POST",url:ajaxurl,data:{action:"extend_course_subscription",security:$("#bulk_action").val(),course:i.attr("data-course"),members:JSON.stringify(t),extend_amount:$("#extend_amount").val()},cache:!1,success:function(e){i.html(e),setTimeout(function(){i.html(a)},5e3)}})}),$("body").delegate("#mark-complete","media_loaded",function(e){e.preventDefault(),$(this).hasClass("tip")&&$(this).addClass("disabled")}),$("body").delegate("#mark-complete","media_complete",function(e){e.preventDefault(),$(this).hasClass("tip")&&($(this).removeClass("disabled"),$(this).removeClass("tip"),$(this).tooltip("destroy"),jQuery(".tip").tooltip())}),$("body").delegate("#mark-complete","click",function(e){if(e.preventDefault(),$(this).hasClass("disabled"))return!1;var t=$(this),i=$(this).attr("data-unit");t.prepend('<i class="icon-sun-stroke animated spin"></i>'),$("body").find(".course_progressbar").removeClass("increment_complete"),$.ajax({type:"POST",url:ajaxurl,data:{action:"complete_unit",security:$("#hash").val(),course_id:$("#course_id").val(),id:i},cache:!1,success:function(e){t.find("i").remove(),t.html('<i class="icon-check"></i>'),$(".course_timeline").find(".active").addClass("done"),$("body").find(".course_progressbar").trigger("increment"),$("#mark-complete").addClass("disabled"),$("#mark-complete").html('<div class="icon-mark-complete_done"></div>');var i="course_progress"+$("#course_id").val(),a=$(".course_progressbar").attr("data-value");$.cookie(i,a,{expires:1,path:"/"}),e.length>0&&jQuery.isNumeric(e)&&($("#next_unit").removeClass("hide"),$("#next_unit").attr("data-unit",e),$("#next_quiz").removeClass("hide"),$("#next_quiz").attr("data-unit",e),$("#unit"+e).find("a").addClass("unit"),$("#unit"+e).find("a").attr("data-unit",e)),"undefined"!=typeof unit&&$(".unit_timer").trigger("finish")}})}),$(".course_progressbar").on("increment",function(e){if($(this).hasClass("increment_complete"))return e.stopPropagation(),!1;var t=parseFloat($(this).attr("data-increase-unit")),i=parseFloat($(this).attr("data-value"));newper=t+i,newper=newper.toFixed(2);var a=100/t;a=a.toFixed(2);var s=t*a;return s=s.toFixed(2),newper==s&&(newper=100),newper>100&&(newper=100),$(this).find(".bar").css("width",newper+"%"),$(this).find(".bar span").html(newper+"%"),$(this).addClass("increment_complete"),$(this).attr("data-value",newper),$.ajax({type:"POST",url:ajaxurl,async:!0,data:{action:"record_course_progress",security:$("#hash").val(),course_id:$("#course_id").val(),progress:newper},cache:!1,cache:!1,success:function(e){var t="course_progress"+$("#course_id").val();$.cookie(t,newper,{path:"/"})}}),e.stopPropagation(),!1}),$(".course_progressbar").on("decrement",function(e){if($(this).hasClass("increment_complete"))return e.stopPropagation(),!1;var t=parseFloat($(this).attr("data-increase-unit")),i=parseFloat($(this).attr("data-value"));return newper=i-t,newper<0&&(newper=0),$(this).find(".bar").css("width",newper+"%"),$(this).find(".bar span").html(newper+"%"),$(this).addClass("increment_complete"),$(this).attr("data-value",newper),$.ajax({type:"POST",url:ajaxurl,async:!0,data:{action:"record_course_progress",security:$("#hash").val(),course_id:$("#course_id").val(),progress:newper},cache:!1,success:function(e){var t="course_progress"+$("#course_id").val();$.cookie(t,newper,{path:"/"})}}),e.stopPropagation(),!1}),jQuery(document).ready(function(e){e(".showhide_indetails").click(function(t){t.preventDefault(),e(this).find("i").toggleClass("icon-minus"),e(this).parent().find(".in_details").toggle()}),e(".ajax-certificate").each(function(){e(this).magnificPopup({type:"ajax",fixedContentPos:!0,alignTop:!0,preloader:!1,midClick:!0,removalDelay:300,showCloseBtn:!1,mainClass:"mfp-with-zoom",callbacks:{parseAjax:function(t){t.data=e(t.data).find("#certificate")},ajaxContentAdded:function(){html2canvas(e("#certificate"),{backgrounnd:"#ffffff",onrendered:function(t){var i=t.toDataURL("image/jpeg");e("#certificate .certificate_content").html('<img src="'+i+'" width="'+e("#certificate .certificate_content").attr("data-height")+'" height="'+e("#certificate .certificate_content").attr("data-width")+'" />'),e("#certificate").trigger("generate_certificate");var a=new jsPDF,s=80;e("#certificate .certificate_content").attr("data-width").length&&(s=Math.round(210*parseInt(e("#certificate .certificate_content").attr("data-height"))/parseInt(e("#certificate .certificate_content").attr("data-width")))),a.addImage(i,"JPEG",0,0,210,s),e(".certificate_pdf").click(function(){a.output("dataurlnewwindow")})}})}}})}),e(".ajax-badge").each(function(){var t=e(this),i=t.find("img");e(this).magnificPopup({items:{src:'<div class="badge-popup"><img src="'+i.attr("src")+'" /><h3>'+t.attr("title")+"</h3><strong>"+vibe_course_module_strings.for_course+" "+t.attr("data-course")+"</strong></div>",type:"inline"},fixedContentPos:!1,alignTop:!1,preloader:!1,midClick:!0,removalDelay:300,showCloseBtn:!1,mainClass:"mfp-with-zoom center-aligned"})}),e("body").delegate(".print_unit","click",function(t){e(".unit_content").print()}),e("body").delegate(".printthis","click",function(t){e(this).parent().print()}),e("body").delegate("#certificate","generate_certificate",function(t){e(this).addClass("certificate_generated")}),e("body").delegate(".certificate_print","click",function(t){t.preventDefault(),e(this).parent().parent().print()}),e(".widget_carousel").flexslider({animation:"slide",controlNav:!1,directionNav:!0,animationLoop:!0,slideshow:!1,prevText:"<i class='icon-arrow-1-left'></i>",nextText:"<i class='icon-arrow-1-right'></i>"}),e("body").delegate(".unit-page-links a","click",function(t){if(!e("body").hasClass("single-unit")){t.preventDefault();var i=e(this);i.prepend('<i class="icon-sun-stroke animated spin"></i>'),e(".main_unit_content").load(i.attr("href")+" .single_unit_content",function(){e(".unit_content").trigger("unit_traverse"),e("body").trigger("unit_loaded")}),i.find("i").remove(),e(".main_unit_content").trigger("unit_reload")}}),e("body").delegate(".pricing_course","click",function(t){e(this).toggleClass("active")}),e("body").delegate(".pricing_course li","click",function(t){var i=e(this).parent(),a=e(this);if(i.find(".active").removeClass("active"),a.addClass("active"),e(".course_button").length){var s=e(this).attr("data-value");e(".course_button").attr("href",s)}})}),$(".unit_content").on("unit_traverse",function(){runnecessaryfunctions(),$("body,html").animate({scrollTop:0},1200)}),$("body").delegate(".unit","click",function(e){if(e.preventDefault(),$(this).hasClass("disabled"))return!1;var t=$(this),i=$(this).attr("data-unit");t.prev().is("span")?t.prev().addClass("loading"):t.prepend('<i class="icon-sun-stroke animated spin"></i>'),$("#ajaxloader").removeClass("disabled"),$(".unit_content").addClass("loading"),$.ajax({type:"POST",url:ajaxurl,data:{action:"unit_traverse",security:$("#hash").val(),course_id:$("#course_id").val(),id:i},cache:!1,success:function(e){t.prev().is("span")?t.prev().removeClass("loading"):t.find("i").remove(),$("#ajaxloader").addClass("disabled"),$(".unit_content").removeClass("loading"),$(".unit_content").html(e);var i=$($.parseHTML(e)).filter("#unit"),a="#unit"+i.attr("data-unit");$(".course_timeline").find(".active").removeClass("active"),$(a).addClass("active"),$(".unit_content").trigger("unit_traverse"),$("audio,video").mediaelementplayer({success:function(e,t,i){$("#mark-complete").trigger("media_loaded"),$(".mejs-container").each(function(){$(this).addClass("mejs-mejskin")}),e.addEventListener("ended",function(e){$("#mark-complete").trigger("media_complete")})}}),runnecessaryfunctions(),$(".unit_wrap").hasClass("enable_comments")&&$(".unit_content").trigger("load_comments"),"undefined"!=typeof i&&$(".unit_timer").trigger("activate")}})}),$("body").delegate(".unit_content","load_comments",function(e){if(!$(this).find(".main_unit_content").hasClass("stop_notes")&&!$("body").hasClass("wp-fee-body")){var t=$("#unit").attr("data-unit");$(".unit_content p").each(function(e){$(this).parents(".question").length||($(this).attr("data-section-id",e),$(this).append('<span id="c'+e+'" class="side_comment">+</span>'))}),unitComments(),$.ajax({type:"POST",dataType:"json",url:ajaxurl,data:{action:"get_unit_comment_count",security:$("#hash").val(),unit_id:t},cache:!1,success:function(e){$.each(e,function(e,t){$("#"+t.id).text(t.count)})}}),$(".side_comment").on("click",function(){if($(this).hasClass("active"))return!1;var e=$(this),i=$(".side_comment.active").attr("id");$(".side_comment").removeClass("active"),$('.side_comments .main_comments>li:not(".hide")').remove(),$(this).addClass("active");var a=$(this).attr("id");$(".add-comment").fadeIn(),$(".add-comment").next().fadeOut();var s=$(this).text(),n="#";if($(".side_comments .main_comments").find(".loaded").remove(),jQuery.isNumeric(s)){var r="",o="unit_comments"+t,c=sessionStorage.getItem(o);null!==c?(c=JSON.parse(c),$.each(c,function(i,s){$.each(s,function(i,s){a==i&&(r+='<li class="loaded"><div class="'+s.type+" user"+s.author.user_id+'" data-id="'+s.ID+'"><img src="'+s.author.img+'"><a href="'+s.author.link+'" class="unit_comment_author">'+s.author.name+'</a><div class="unit_comment_content">'+s.content+'</div><ul class="actions" data-pid="'+e.attr("id")+'">',jQuery.each(s.controls,function(e,t){t>1&&jQuery(".side_comments li.hide").find("."+e).addClass("meta_info").attr("data-meta",t);var i=jQuery(".side_comments li.hide").find("."+e).parent()[0].outerHTML;t>1&&jQuery(".side_comments li.hide").find("."+e).removeClass("meta_info").removeAttr("data-meta"),r+=i}),r+="</ul></div></li>",n=$(r).find(".popup_unit_comment").removeClass("meta_info").attr("data-href"),n+="?unit_id="+t+"&section="+i)})}),$(".side_comments .main_comments").append(r),$(".side_comments .main_comments .popup_unit_comment").attr("href",n),jQuery(".tip").tooltip(),$(".popup_unit_comment").magnificPopup({type:"ajax",alignTop:!0,fixedContentPos:!0,fixedBgPos:!0,overflowY:"auto",closeBtnInside:!0,preloader:!1,midClick:!0,removalDelay:300,mainClass:"my-mfp-zoom-in",callbacks:{parseAjax:function(e){e.data=$(e.data).find(".content")}}})):(i=$(".side_comment.active").attr("id"),$.ajax({type:"POST",dataType:"json",url:ajaxurl,data:{action:"unit_section_comments",security:$("#hash").val(),unit_id:t,section:i,num:$(".side_comment").length},cache:!1,success:function(i){var s=JSON.stringify(i);sessionStorage.setItem(o,s),$.each(i,function(i,s){$.each(s,function(i,s){if(a==i){r+='<li class="loaded"><div class="'+s.type+" user"+s.author.user_id+'" data-id="'+s.ID+'"><img src="'+s.author.img+'"><a href="'+s.author.link+'" class="unit_comment_author">'+s.author.name+'</a><div class="unit_comment_content">'+s.content+'</div><ul class="actions" data-pid="'+e.attr("id")+'">',jQuery.each(s.controls,function(e,t){t>1&&jQuery(".side_comments li.hide").find("."+e).addClass("meta_info").attr("data-meta",t);var i=jQuery(".side_comments li.hide").find("."+e).parent()[0].outerHTML;t>1&&jQuery(".side_comments li.hide").find("."+e).removeClass("meta_info").removeAttr("data-meta"),r+=i}),r+="</ul></div></li>";var n=$(r).find(".popup_unit_comment").attr("href");n+="?unit_id="+t+"&section="+i,$(r).find(".popup_unit_comment").attr("href",n)}})}),$(".side_comments .main_comments").append(r),jQuery(".tip").tooltip(),$(".popup_unit_comment").magnificPopup({type:"ajax",alignTop:!0,fixedContentPos:!0,fixedBgPos:!0,overflowY:"auto",closeBtnInside:!0,preloader:!1,midClick:!0,removalDelay:300,mainClass:"my-mfp-zoom-in",callbacks:{parseAjax:function(e){e.data=$(e.data).find(".content")}}})}}))}var l=$("#all_comments_link").attr("data-href");l+="?unit_id="+t+"&section="+$(".side_comment.active").attr("id"),$("#all_comments_link").attr("href",l);var u=$(this).offset().top,d=$("#unit_content").offset().top,m=$(".side_comments").height(),_=$(".unit_prevnext").offset().top;if(u+m>_?u=_-d-m:u-=d,u>0)$(".side_comments").css("top",u+"px"),$(".side_comments").removeClass("scroll");else{$(".side_comments").addClass("scroll");var h=$(".main_unit_content").height();$(".side_comments").css("height",h+"px")}})}}),jQuery(document).ready(function(e){e(".add-comment").on("click",function(){e(this).fadeOut(0),e(this).next(".comment-form").fadeIn(100)}),e(".new_side_comment").on("click",function(){e(this).hasClass("cleared")||(e(this).html(""),e(this).addClass("cleared"),e(this).parent().parent().addClass("active"),e(this).parent().parent().parent().find(".add-comment").addClass("deactive"))}),e(".remove_side_comment").on("click",function(){e(this).closest(".side_comments").find(".add-comment").fadeIn(100),e(this).closest(".comment-form").fadeOut(),e(".new_side_comment").removeClass("cleared"),e(".new_side_comment").text(vibe_course_module_strings.add_comment)})}),$("body").delegate(".public_unit_comment","click",function(e){e.preventDefault();var t=$(this),i=t.closest("li.loaded>div").attr("data-id");$.ajax({type:"POST",url:ajaxurl,data:{action:"public_user_comment",security:$("#hash").val(),id:i},cache:!1,success:function(e){t.removeClass("public_unit_comment"),t.addClass("private_unit_comment"),t.find("i").removeClass().addClass("icon-fontawesome-webfont-4"),t.attr("data-original-title",vibe_course_module_strings.private_comment);var i=$("#unit").attr("data-unit"),a="unit_comments"+i;sessionStorage.removeItem(a)}})}),$("body").delegate(".private_unit_comment","click",function(e){e.preventDefault();var t=$(this),i=t.closest("li.loaded>div").attr("data-id");$.ajax({type:"POST",url:ajaxurl,data:{action:"private_user_comment",security:$("#hash").val(),id:i},cache:!1,success:function(e){t.removeClass("private_unit_comment"),t.addClass("public_unit_comment"),t.find("i").removeClass().addClass("icon-fontawesome-webfont-3"),t.attr("data-original-title",vibe_course_module_strings.public_comment);var i=$("#unit").attr("data-unit"),a="unit_comments"+i;sessionStorage.removeItem(a)}})}),$("body").delegate(".edit_unit_comment","click",function(e){e.preventDefault();var t=$(this),i=t.parent().parent().parent(),a=$(".comment-form").first().clone(),s=i.find("img").clone(),n=i.find(".unit_comment_author").clone(),r=i.attr("data-id");a.find("img").replaceWith(function(){return s}),a.find("span").replaceWith(function(){return n});var o=i.find(".unit_comment_content");a.find(".new_side_comment").html(o.html()),a.find(".post_unit_comment").removeClass().addClass("edit_form_unit_comment").attr("data-id",r),a.find(".remove_side_comment").removeClass().addClass("remove_form_edit_unit_comment"),i.parent().append(a),i.hide(),i.parent().find(".comment-form").show()}),$("body").delegate(".remove_form_edit_unit_comment","click",function(e){$(this).parent().parent().parent().parent().find(".note,.public").show(),$(this).closest(".comment-form").remove(),$(".new_side_comment").removeClass("cleared")}),$("body").delegate(".reply_unit_comment","click",function(e){e.preventDefault();var t=$(this).parent().parent().parent().parent();if($(this).hasClass("meta_info")){var i=$(this).attr("data-meta");$.ajax({type:"POST",url:ajaxurl,data:{action:"get_user_reply",security:$("#hash").val(),id:i},cache:!1,success:function(e){jQuery.isNumeric(e)||t.after(e)}})}else $(".add-comment").trigger("click"),$(".comment-form").addClass("creply"),$(".comment-form").attr("data-cid",$(this).closest(".actions").parent().attr("data-id"))}),$("body").delegate(".instructor_reply_unit_comment","click",function(e){if(e.preventDefault(),$(this).hasClass("call"))return!1;var t=$(this),i=t.parent().parent().parent().find(".unit_comment_content").html(),a=$("#unit").attr("data-unit");$.ajax({type:"POST",url:ajaxurl,data:{action:"instructor_reply_user_comment",security:$("#hash").val(),message:i,id:a,section:$(".side_comment.active").attr("id")},cache:!1,success:function(e){t.addClass("call")}})}),$("body").delegate(".edit_form_unit_comment","click",function(e){e.preventDefault();var t=$(this),i=t.attr("data-id"),a=$(".new_side_comment").html();$.ajax({type:"POST",url:ajaxurl,data:{action:"edit_user_comment",security:$("#hash").val(),content:a,id:i},cache:!1,success:function(e){var i=$("#unit").attr("data-unit"),s="unit_comments"+i;sessionStorage.removeItem(s);var n=t.closest(".comment-form").prev().parent();n.find(".unit_comment_content").html(a),t.closest(".comment-form").remove(),n.find(".note,.public").show()}})}),$("body").delegate(".remove_unit_comment","click",function(e){e.preventDefault();var t=$(this),i=t.parent().parent().closest("li>div").attr("data-id"),a=t.parent().parent().closest("li>div").parent();t.addClass("animated spin"),$.confirm({text:vibe_course_module_strings.remove_comment,confirm:function(){$.ajax({type:"POST",url:ajaxurl,data:{action:"remove_user_comment",security:$("#hash").val(),id:i},cache:!1,success:function(e){t.removeClass("animated"),t.removeClass("spin"),a.remove();var i=t.closest(".actions").attr("data-pid"),s=parseInt($("#"+i).text());s--,$("#"+i).text(s),t.closest("li.loaded").fadeOut(200,function(){$(this).remove()});var n=$("#unit").attr("data-unit"),r="unit_comments"+n;$(".new_side_comment").removeClass("cleared"),sessionStorage.removeItem(r)}})},cancel:function(){t.removeClass("animated"),t.removeClass("spin")},confirmButton:vibe_course_module_strings.remove_comment_button,cancelButton:vibe_course_module_strings.cancel})}),$("body").delegate(".post_unit_comment","click",function(e){if(e.preventDefault(),$(this).hasClass("disabled"))return!1;var t=0;$(this).closest(".comment-form").hasClass("creply")&&(t=$(this).closest(".comment-form").attr("data-cid"));var i=$(this),a=$(".side_comment.active").attr("id"),s=$("#unit").attr("data-unit"),n=i.closest(".side_comments").find("ul.main_comments"),r=n.find("li.hide").clone(),o=$(this).closest(".comment-form").find(".new_side_comment").html();i.addClass("disabled"),$.ajax({type:"POST",url:ajaxurl,data:{action:"post_unit_comment",security:$("#hash").val(),course_id:$("#course_id").val(),unit_id:s,content:o,section:a,reply:t},cache:!1,success:function(e){if(i.removeClass("disabled"),jQuery.isNumeric(e)){var t="unit_comments"+s;$.cookie(t),{section:{content:o,type:"note",author:{img:r.find("img").attr("src"),name:r.find(".unit_comment_author").text(),link:r.find(".unit_comment_author").attr("href")},controls:{edit_unit_comment:1,public_unit_comment:1,instructor_reply_unit_comment:1,popup_unit_comment:1,remove_unit_comment:1}}};sessionStorage.removeItem(t),r.find(".unit_comment_content").html(o),r.find(".note").attr("data-id",e),r.removeClass(),r.find(".actions .private_unit_comment").parent().remove(),n.append(r);var c=$(r).find(".popup_unit_comment").attr("data-href");c+="?unit_id="+s+"&section="+$(".side_comment.active").attr("id"),$(r).find(".popup_unit_comment").attr("href",c),jQuery(".tip").tooltip();var l=$("#"+a).text();l=jQuery.isNumeric(l)?parseInt(l)+1:1,$(".new_side_comment").removeClass("cleared"),$("#"+a).text(l),$(".add-comment").fadeIn(),$(".comment-form").removeClass("active").fadeOut(),$(".new_side_comment").text(vibe_course_module_strings.add_comment),$(".popup_unit_comment").magnificPopup({type:"ajax",alignTop:!0,fixedContentPos:!0,fixedBgPos:!0,overflowY:"auto",closeBtnInside:!0,preloader:!1,midClick:!0,removalDelay:300,mainClass:"my-mfp-zoom-in",callbacks:{parseAjax:function(e){e.data=$(e.data).find(".content")}}})}else i.closest(".comment-form").append('<div class="error">'+e+"</div>")}})}),$("body").delegate(".note-tabs li","click",function(e){e.preventDefault(),$(this).parent().find(".selected").removeClass("selected"),$(this).addClass("selected");var t=$(this).attr("id");$.ajax({type:"POST",url:ajaxurl,data:{action:t,security:$("#hash").val(),unit_id:$.urlParam("unit_id"),section:$.urlParam("section")},cache:!1,success:function(e){$(".content").html(e),$(".live-edit").liveEdit({afterSaveAll:function(e){return!1}})}})}),$("body").delegate("#load_more_notes","click",function(e){var t=$("#notes_query").html();$.ajax({type:"POST",url:ajaxurl,data:{action:"load_more_notes",security:$("#hash").val(),json:t},cache:!1,success:function(e){if(jQuery.isNumeric(e))$("#load_more_notes").hide();else{var t=$(e).filter("#new_notes_query").html();$("#notes_query").html(t),$("#notes_discussions .notes_list").append(e),$("#new_notes_query").remove()}$(".live-edit").liveEdit({afterSaveAll:function(e){return!1}})}})}),jQuery(document).ready(function(){jQuery(".course_curriculum.accordion .course_section").click(function(e){jQuery(this).toggleClass("show"),jQuery(this).nextUntil(".course_section").toggleClass("show")}),jQuery(".course_timeline.accordion .section").on("click",function(e){jQuery(this).toggleClass("show"),jQuery(this).nextUntil(".section").toggleClass("show")}),jQuery(".course_timeline.accordion").each(function(){var e=$(this);e.find(".unit_line.active").prevAll(".section").trigger("click")}),$(".unit_content").on("unit_traverse",function(){var e=$(".course_timeline.accordion").find(".unit_line.active").prev(".section");$(".course_timeline.accordion").find(".unit_line.active").prev().hasClass("section")&&jQuery(".course_timeline.accordion .section.show").trigger("click"),e.hasClass("show")||e.trigger("click")}),$(".retake_submit").click(function(){$(this).parent().submit()})}),$(document).ready(function(){$(".inquiz_timer").each(function(){$(".inquiz_timer").one("activate",function(){var e=parseInt($(this).attr("data-time")),t=$(this).find(".timer"),i=$(this);t.timer({timer:e,width:72,height:72,fgColor:vibe_course_module_strings.theme_color}),t.on("change",function(){var e=i.find(".countdown"),a=parseInt(t.attr("data-timer"));if(a>0){a--,t.attr("data-timer",a);var s="";s=a>60?Math.floor(a/60)+":"+(parseInt(a%60)<10?"0"+parseInt(a%60):parseInt(a%60)):"00:"+(10>a?"0"+a:a),e.html(s)}else e.html(vibe_course_module_strings.timeout),$(".submit_inquiz").hasClass("triggerred")||($(".submit_inquiz").addClass("triggerred"),$(".submit_inquiz").trigger("click")),$(".inquiz_timer").trigger("deactivate")})}),$(".inquiz_timer").one("deactivate",function(e){var t=0,i=$(this).find(".timer");$(this);i.knob({readonly:!0,max:t,width:72,height:72,fgColor:vibe_course_module_strings.theme_color,readonly:!0}),e.stopPropagation()});var e=parseInt($(this).attr("data-time")),t=$(this).find(".timer");t.knob({readonly:!0,max:e,width:72,height:72,fgColor:vibe_course_module_strings.theme_color,thickness:.1,readonly:!0}),$(this).hasClass("start")&&$(".inquiz_timer").trigger("activate")})}),$(".unit_content").on("unit_traverse",function(){$(".inquiz_timer").each(function(){$(".inquiz_timer").one("activate",function(){var e=parseInt($(this).attr("data-time")),t=$(this).find(".timer"),i=$(this);t.timer({timer:e,width:72,height:72,fgColor:vibe_course_module_strings.theme_color}),t.on("change",function(){var e=i.find(".countdown"),a=parseInt(t.attr("data-timer"));if(a>0){a--,t.attr("data-timer",a);var s="";s=a>60?Math.floor(a/60)+":"+(parseInt(a%60)<10?"0"+parseInt(a%60):parseInt(a%60)):"00:"+(10>a?"0"+a:a),e.html(s)}else e.html(vibe_course_module_strings.timeout),$(".submit_inquiz").hasClass("triggerred")||($(".submit_inquiz").addClass("triggerred"),$(".submit_inquiz").trigger("click")),$(".inquiz_timer").trigger("deactivate")})}),$(".inquiz_timer").one("deactivate",function(e){var t=0,i=$(this).find(".timer");$(this);i.knob({readonly:!0,max:t,width:72,height:72,fgColor:vibe_course_module_strings.theme_color,readonly:!0}),e.stopPropagation()});var e=parseInt($(this).attr("data-time")),t=$(this).find(".timer");t.knob({readonly:!0,max:e,width:72,height:72,fgColor:vibe_course_module_strings.theme_color,thickness:.1,readonly:!0}),$(this).hasClass("start")&&$(".inquiz_timer").trigger("activate")})}),$("body").delegate(".unit_button.start_quiz","click",function(e){e.preventDefault();var t=$(this);$("#ajaxloader").removeClass("disabled"),$("#unit_content").addClass("loading"),t.hasClass("continue")?$.ajax({type:"POST",url:ajaxurl,data:{action:"in_start_quiz",security:$("#hash").val(),quiz_id:$("#unit.quiz_title").attr("data-unit")},cache:!1,success:function(e){$(".main_unit_content").html(e),$(".in_quiz").trigger("question_loaded"),t.removeClass("start_quiz continue"),t.attr("href","#"),t.addClass("submit_inquiz"),runnecessaryfunctions(),t.text(vibe_course_module_strings.submit_quiz),$(".quiz_title .inquiz_timer").trigger("activate"),$("#ajaxloader").addClass("disabled"),$("#unit_content").removeClass("loading")}}):$.confirm({text:vibe_course_module_strings.start_quiz_notification,confirm:function(){$.ajax({type:"POST",url:ajaxurl,data:{action:"in_start_quiz",security:$("#hash").val(),quiz_id:$("#unit.quiz_title").attr("data-unit")},cache:!1,success:function(e){$("#ajaxloader").addClass("disabled"),$("#unit_content").removeClass("loading"),$(".main_unit_content").html(e),$(".in_quiz").trigger("question_loaded"),t.removeClass("start_quiz"),t.attr("href","#"),t.addClass("submit_inquiz"),runnecessaryfunctions(),t.text(vibe_course_module_strings.submit_quiz),$(".quiz_title .inquiz_timer").trigger("activate")}})},cancel:function(){$("#ajaxloader").addClass("disabled"),$("#unit_content").removeClass("loading")},confirmButton:vibe_course_module_strings.confirm,cancelButton:vibe_course_module_strings.cancel})}),$("body").delegate(".unit_button.submit_inquiz","click",function(e){e.preventDefault();var t=$(this),i=[];if($("#ajaxloader").removeClass("disabled"),$("#unit_content").addClass("loading"),"undefined"!=typeof all_questions_json){var a=0;$.each(all_questions_json,function(e,t){var s=localStorage.getItem(t);if(s){var n={id:t,value:s};i.push(n)}else a++}),t.hasClass("triggerred")?$.ajax({type:"POST",url:ajaxurl,data:{action:"in_submit_quiz",security:$("#hash").val(),quiz_id:$("#unit.quiz_title").attr("data-unit"),answers:JSON.stringify(i)},cache:!1,success:function(e){if($("#ajaxloader").addClass("disabled"),$("#unit_content").removeClass("loading"),e.indexOf("##")>=0){var i=e.substr(0,e.indexOf("##"));e=e.substr(e.indexOf("##")),i.length>0&&($("#next_unit").removeClass("hide"),$("#next_unit").attr("data-unit",i),$("#next_quiz").removeClass("hide"),$("#next_quiz").attr("data-unit",i),$("#unit"+i).find("a").addClass("unit"),$("#unit"+i).find("a").attr("data-unit",i))}else 0==e.indexOf("##")?(e=e.substr(2),console.log(e)):$("#next_unit").removeClass("hide");$(".main_unit_content").html(e),$(".quiz_title .inquiz_timer").trigger("deactivate"),$(".in_quiz").trigger("question_loaded"),t.removeClass("submit_inquiz"),$(".quiz_title .quiz_meta").addClass("hide"),t.addClass("quiz_results_popup"),t.attr("href",$("#results_link").val()),runnecessaryfunctions(),t.text(vibe_course_module_strings.check_results),$("#unit"+$("#unit.quiz_title").attr("data-unit")).addClass("done"),$("body").find(".course_progressbar").removeClass("increment_complete"),$("body").find(".course_progressbar").trigger("increment")}}):a?$.confirm({text:vibe_course_module_strings.unanswered_questions,confirm:function(){$.confirm({text:vibe_course_module_strings.submit_quiz_notification,confirm:function(){$.ajax({type:"POST",url:ajaxurl,data:{action:"in_submit_quiz",security:$("#hash").val(),quiz_id:$("#unit.quiz_title").attr("data-unit"),answers:JSON.stringify(i)},cache:!1,success:function(e){if($("#ajaxloader").addClass("disabled"),$("#unit_content").removeClass("loading"),e.indexOf("##")>=0){var i=e.substr(0,e.indexOf("##"));e=e.substr(e.indexOf("##")+2),i.length>0&&($("#next_unit").removeClass("hide"),$("#next_unit").attr("data-unit",i),$("#next_quiz").removeClass("hide"),$("#next_quiz").attr("data-unit",i),$("#unit"+i).find("a").addClass("unit"),$("#unit"+i).find("a").attr("data-unit",i))}else 0==e.indexOf("##")&&(e=e.substr(2)),$("#next_unit").removeClass("hide");$(".main_unit_content").html(e),$(".quiz_title .inquiz_timer").trigger("deactivate"),$(".in_quiz").trigger("question_loaded"),t.removeClass("submit_inquiz"),$(".quiz_title .quiz_meta").addClass("hide"),t.addClass("quiz_results_popup"),t.attr("href",$("#results_link").val()),runnecessaryfunctions(),t.text(vibe_course_module_strings.check_results),$("#unit"+$("#unit.quiz_title").attr("data-unit")).addClass("done"),$("body").find(".course_progressbar").removeClass("increment_complete"),$("body").find(".course_progressbar").trigger("increment")}})},cancel:function(){$("#ajaxloader").addClass("disabled"),$("#unit_content").removeClass("loading")},confirmButton:vibe_course_module_strings.confirm,cancelButton:vibe_course_module_strings.cancel})},cancel:function(){return $("#ajaxloader").addClass("disabled"),$("#unit_content").removeClass("loading"),!1},confirmButton:vibe_course_module_strings.confirm,cancelButton:vibe_course_module_strings.cancel}):$.ajax({type:"POST",url:ajaxurl,data:{action:"in_submit_quiz",security:$("#hash").val(),quiz_id:$("#unit.quiz_title").attr("data-unit"),answers:JSON.stringify(i)},cache:!1,success:function(e){if($("#ajaxloader").addClass("disabled"),$("#unit_content").removeClass("loading"),e.indexOf("##")){var i=e.substr(0,e.indexOf("##"));e=e.substr(e.indexOf("##")+2),i.length>0&&($("#next_unit").removeClass("hide"),$("#next_unit").attr("data-unit",i),$("#next_quiz").removeClass("hide"),$("#next_quiz").attr("data-unit",i),$("#unit"+i).find("a").addClass("unit"),$("#unit"+i).find("a").attr("data-unit",i))}$(".main_unit_content").html(e),$(".quiz_title .inquiz_timer").trigger("deactivate"),$(".in_quiz").trigger("question_loaded"),t.removeClass("submit_inquiz"),$(".quiz_title .quiz_meta").addClass("hide"),t.addClass("quiz_results_popup"),t.attr("href",$("#results_link").val()),runnecessaryfunctions(),t.text(vibe_course_module_strings.check_results),$("#unit"+$("#unit.quiz_title").attr("data-unit")).addClass("done"),$("body").find(".course_progressbar").removeClass("increment_complete"),$("body").find(".course_progressbar").trigger("increment")}})}else $("#ajaxloader").addClass("disabled"),$("#unit_content").removeClass("loading"),alert(vibe_course_module_strings.submit_quiz_error)}),$("body").delegate(".in_quiz .pagination ul li a.quiz_page","click",function(e){e.preventDefault();var t=$(this),i=$(this).text();$("#ajaxloader").removeClass("disabled"),$("#unit_content").addClass("loading"),$.ajax({type:"POST",url:ajaxurl,data:{action:"in_start_quiz",security:$("#hash").val(),quiz_id:$("#unit.quiz_title").attr("data-unit"),page:i},cache:!1,success:function(e){$("#ajaxloader").addClass("disabled"),$("#unit_content").removeClass("loading"),$(".main_unit_content").html(e),$(".in_quiz").trigger("question_loaded"),t.removeClass("start_quiz"),t.addClass("submit_quiz"),runnecessaryfunctions(),t.text(vibe_course_module_strings.submit_quiz)}})}),$("body").delegate(".in_quiz","question_loaded",function(){if(runnecessaryfunctions(),$(".quiz_meta").trigger("progress_check"),$(".matchgrid_options").hasClass("saved_answer")){var e;$(".matchgrid_options li").each(function(t,i){e=$(".matchgrid_options").attr("data-match"+t),$(this).append($("#"+e))})}jQuery(".in_question .question_options.sort").each(function(){var e="1",t=$("ul.question_options li").size();if(t>1)for(var i=2;t>=i;i++)e=e+","+i;jQuery(this).sortable({revert:!0,cursor:"move",refreshPositions:!0,opacity:.6,scroll:!0,containment:"parent",placeholder:"placeholder",tolerance:"pointer",
update:function(e,t){var i=$(".question_options.sort").sortable("toArray").toString(),a=$(this).parent().attr("data-ques");localStorage.setItem(a,i),$(".quiz_meta").trigger("progress_check")}}).disableSelection()}),$(".live-edit").liveEdit({afterSaveAll:function(e){return!1}}),$(".vibe_fillblank").on("blur",function(){var e=$(this).text(),t=$(this).parent().parent().parent().parent().attr("data-ques");localStorage.setItem(t,e),$(".quiz_meta").trigger("progress_check")}),$(".in_question .question_options.match").each(function(){$(this).droppable({drop:function(e,t){$(t.draggable).removeAttr("style"),$(this).addClass("ui-state-highlight").append($(t.draggable))}}),$(this).find("li").draggable({revert:"invalid",containment:$(this).parent()})}),$(".matchgrid_options li").droppable({activeClass:"ui-state-default",hoverClass:"ui-state-hover",drop:function(e,t){if(childCount=$(this).find("li").length,$(t.draggable).removeAttr("style"),0==childCount){$(this).addClass("ui-state-highlight").append($(t.draggable));var i="";$(this).parent().find("li.match_option").each(function(){var e=$(this).attr("id");jQuery.isNumeric(e)&&(i+=e+",")});var a=$(this).parent().parent().parent().parent().attr("data-ques");localStorage.setItem(a,i),$(".quiz_meta").trigger("progress_check")}}}),$(".question.largetext+textarea").on("blur",function(){var e=$(this).val(),t=$(this).parent().attr("data-ques");localStorage.setItem(t,e),$(".quiz_meta").trigger("progress_check")}),$(".question.smalltext+input").on("blur",function(){var e=$(this).val(),t=$(this).parent().attr("data-ques");localStorage.setItem(t,e),$(".quiz_meta").trigger("progress_check")}),$("#vibe_select_dropdown").change(function(){var e=$(this).parent().parent().parent().attr("data-ques"),t=$(this).val();localStorage.setItem(e,t),$(".quiz_meta").trigger("progress_check")}),$(".question_options.truefalse li").click(function(){var e=$(this).find("input:checked").attr("name"),t=$(this).find("input:checked").val();localStorage.setItem(e,t),$(".quiz_meta").trigger("progress_check")}),$(".question_options.single li").click(function(){var e=$(this).find("input:checked").attr("name"),t=$(this).find("input:checked").val();localStorage.setItem(e,t),$(".quiz_meta").trigger("progress_check")}),$(".question_options.multiple li").click(function(){var e=($(this).find("input:checked").attr("class"),$(this).parent().parent().attr("data-ques")),t="";$(this).parent().find("input:checked").each(function(){t+=$(this).val()+","}),localStorage.setItem(e,t),$(".quiz_meta").trigger("progress_check")})}),$("body").delegate(".in_quiz","question_loaded",function(){"undefined"!=typeof questions_json&&$.each(questions_json,function(e,t){$(".in_question[data-ques="+t+"]").each(function(){var e=$(this),i=$(this).find(".question").attr("class");switch(i){case"question match":var a=localStorage.getItem(t);if(null!==a){var s=a.split(",");$.each(s,function(i,a){$.isNumeric(a)&&e.find(".matchgrid_options>ul>li").eq(i).append($("#"+a+".ques"+t))})}break;case"question sort":var a=localStorage.getItem(t);if(null!==a){var s=a.split(",");$.each(s,function(i,a){$.isNumeric(a)&&e.find(".question_options.sort>li#"+a+".ques"+t).remove().appendTo(".question_options.sort")})}break;case"question single":var a=localStorage.getItem(t);null!==a&&$(this).find('input[value="'+a+'"]').prop("checked",!0);break;case"question multiple":var a=localStorage.getItem(t);if(null!==a){var s=a.split(",");$.each(s,function(t,i){e.find('input[value="'+i+'"]').prop("checked",!0)})}break;case"question select":$(this).find("select").val(localStorage.getItem(t));break;case"question truefalse":var a=localStorage.getItem(t);null!==a&&$(this).find('input[value="'+a+'"]').prop("checked",!0);break;case"question fillblank":var n=localStorage.getItem(t);"null"!==n&&n&&$(this).find(".vibe_fillblank").text(n);break;case"question smalltext":$(this).find("input").val(localStorage.getItem(t));break;case"question largetext":$(this).find("textarea").val(localStorage.getItem(t))}})})}),$("body").delegate(".quiz_meta","progress_check",function(){if("undefined"!=typeof all_questions_json){var e=all_questions_json.length,t=0;$.each(all_questions_json,function(e,i){null!==localStorage.getItem(i)&&t++}),$(".quiz_meta").hasClass("show_progress")||$(".quiz_meta").addClass("show_progress"),$(".quiz_meta i span").text(t+"/"+e);var i=Math.round(100*(t/e));$(".quiz_meta .progress .bar").css("width",i+"%")}}),$(document).ready(function($){$(".unit_content").on("unit_traverse",function(){$(".question").each(function(){var $this=$(this);jQuery(".question_options.sort").each(function(){jQuery(this).sortable({revert:!0,cursor:"move",refreshPositions:!0,opacity:.6,scroll:!0,containment:"parent",placeholder:"placeholder",tolerance:"pointer"}).disableSelection()}),$(".live-edit").liveEdit({afterSaveAll:function(e){return!1}}),$(".question_options.match").droppable({drop:function(e,t){$(t.draggable).removeAttr("style"),$(this).addClass("ui-state-highlight").append($(t.draggable))}}),$(".question_options.match li").draggable({revert:"invalid",containment:"#question"}),$(".matchgrid_options li").droppable({activeClass:"ui-state-default",hoverClass:"ui-state-hover",drop:function(e,t){childCount=$(this).find("li").length,$(t.draggable).removeAttr("style"),0==childCount&&$(this).addClass("ui-state-highlight").append($(t.draggable))}}),$this.find(".check_answer").click(function(){$this.find(".message").remove();var id=$(this).attr("data-id"),answers=eval("ans_json"+id);switch(answers.type){case"select":case"truefalse":case"single":case"sort":case"match":value="",$this.find('input[type="radio"]:checked').length&&(value=$this.find('input[type="radio"]:checked').val()),$this.find("select").length&&(value=$this.find("option:selected").val()),$this.find(".question_options.sort li.sort_option").each(function(){var e=$(this).attr("id");jQuery.isNumeric(e)&&(value+=e+",")}),$this.find(".matchgrid_options li.match_option").each(function(){var e=$(this).attr("id");jQuery.isNumeric(e)&&(value+=e+",")}),("sort"==answers.type||"match"==answers.type)&&(value=value.slice(0,-1)),value==answers.answer?$this.append('<div class="message success">'+vibe_course_module_strings.correct+"</div>"):$this.append('<div class="message error">'+vibe_course_module_strings.incorrect+"</div>");break;case"multiple":$this.find('input[type="checkbox"]:checked').length&&($this.find('input[type="checkbox"]:checked').length==answers.answer.length?($this.find('input[type="checkbox"]:checked').each(function(){return-1==$.inArray($(this).val(),answers.answer)?($this.append('<div class="message error">'+vibe_course_module_strings.incorrect+"</div>"),!1):void 0}),$this.append('<div class="message success">'+vibe_course_module_strings.correct+"</div>")):$this.append('<div class="message error">'+vibe_course_module_strings.incorrect+"</div>"))}})})}),$(".unit_content").on("unit_traverse",function(){$("#discussion").each(function(){var e=$(this);$(".add_comment").click(function(){$(".add_unit_comment_text").toggleClass("hide")}),$("body").delegate(".unit_content .commentlist li .reply","click",function(){var e=$(this);e.addClass("hide"),$(".unit_content .commentlist li .add_unit_comment_text").remove();var t=$("#add_unit_comment").clone().removeClass("hide").attr("id","").appendTo(e.parent());t.find(".post_question").attr("data-parent",e.parent().parent().attr("data-id")),t.find(".post_question").addClass("comment_reply").text(e.text()),t.find(".post_question").removeClass("post_question")}),$("body").delegate(".unit_content .commentlist li .cancel","click",function(e){$(this).parent().parent().find(".reply").length&&($(this).parent().parent().find(".reply").removeClass("hide"),$(this).parent().parent().find(".add_unit_comment_text").remove())}),$("#add_unit_comment .cancel").click(function(){$("#add_unit_comment").addClass("hide")}),$("body").delegate(".post_question,.comment_reply","click",function(t){t.preventDefault();var i=$(this).parent().find("textarea"),a=i.val(),s="";$(this).hasClass("comment_reply")&&(s=$(this).attr("data-parent")),e.addClass("loading"),a.length?(console.log("@1"),$.ajax({type:"POST",url:ajaxurl,data:{action:"add_unit_comment",security:$("#hash").val(),text:a,parent:s,unit_id:e.attr("data-unit")},cache:!1,success:function(t){e.removeClass("loading"),0==t.indexOf("<li")?(s?($("#comment-"+s).append('<ul class="children">'+t+"</ul>"),$("#comment-"+s+" .add_unit_comment_text").remove(),$(".unit_content .commentlist li .reply").removeClass("hide")):e.find("ol.commentlist").append(t),i.val(""),$(".add_unit_comment_text").addClass("hide")):e.append(t)}})):e.append('<div class="message">'+vibe_course_module_strings.incorrect+"</div>")}),$(".load_more_comments").click(function(){var t=parseInt($(this).attr("data-page")),i=parseInt($(this).attr("data-max")),a=$(this);e.addClass("loading"),$.ajax({type:"POST",url:ajaxurl,data:{action:"load_unit_comments",security:$("#hash").val(),page:t,unit_id:e.attr("data-unit")},cache:!1,success:function(s){e.removeClass("loading"),e.find(".commentlist").append(s);var n=parseInt(a.find("span").text()),r=parseInt(a.attr("data-per"));n-=r,t++,a.attr("data-page",t),a.find("span").text(n),t>=i&&a.hide(200)}})})})}),$(".unit_content").length&&$(".unit_content").trigger("unit_traverse")})}(jQuery);